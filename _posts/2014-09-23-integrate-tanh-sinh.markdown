---
layout: post
title:  "Численное интегрирование: tanh-sinh"
date:   2014-09-23 21:12:19
categories: интегрирование
---

## Общие соображения

Пусть подынтегральная функция непрерывна на промежутке интегрирования
$$ [a, b] $$ вместе со своими $$ 2m+2 $$ производными. Воспользуемся формулой
Эйлера-Маклорена:

$$
    \int\limits_a^b f(x) dx = h\sum_{j=0}^n f(x_j) -
    \frac{h}{2}\left[f(a) + f(b)\right] -
    \sum_{i=1}^m \frac{h^{2i}B_{2i}}{(2i)!}
    \left[f^{(2i-1)}(b) - f^{(2i-1)}(a)\right] + E(h, m),
$$

где $$ h = (b - a) / n,\ x_j = a + jh $$, $$ B_{2i} $$ -- числа Бернулли,
а остаточный член $$ E(h, m) $$ имеет вид

$$
    E(h, m) = \frac{h^{2m+2}(b-a)B_{2m+2} f^{(2m+2)}(\xi)}{(2m+2)!},\quad
    \xi\in(a, b).
$$

Если функция $$ f $$ достаточно быстро стремится к нулю на концах интервала
вместе со всеми своими $$ 2m + 2 $$ производными, то формула упрощается:

$$
    \int\limits_a^b f(x) dx \approx h\sum_{j=0}^n f(x_j).
$$

Основная проблема заключается в том, что подынтегральная функция редко
удовлетворяет этим условиям. Но мы можем ей с этим помочь.

Без потери общности рассмотрим интеграл на отрезке $$ [-1, 1] $$:

$$
    I = \int\limits_{-1}^{1} f(x) dx.
$$

Теперь выполним замену переменной $$ x = g(t) $$, причем функцию $$ g(t) $$
выберем так, чтобы $$ g(-\infty) = -1,\ g(\infty) = 1 $$ и она достаточно быстро
стремилась к нулю со всеми своими производными при $$ t \to \infty $$. Тогда

$$
    I = \int\limits_{-\infty}^{\infty} f(g(t)) g'(t) dt \approx
    h\sum_{j = -\infty}^\infty w_j f(x_j),\ x_j = g(jh),\ w_j = g'(jh).
$$

В качестве функции $$ g(t) $$ обычно выбирают $$ \tanh(\frac{\pi}{2}\sinh(t)) $$
или $$ \mathrm{erf}(t) $$ для интегрирования на конечном интервале и
$$ \sinh(\sinh(t)) $$ для несобственных интегралов.

## tanh-sinh

В методе tanh-sinh

$$
    g(t) = \tanh\left(\frac{\pi}{2}\sinh(t)\right),\quad
    x_j = \tanh\left(\frac{\pi}{2}\sinh(jh)\right),\quad
    w_j = w_{-j} = \frac{\frac{\pi}{2}\cosh(jh)}
                        {\cosh^2\left(\frac{\pi}{2}\sinh(jh)\right)},
$$

а выражение для интеграла принимает вид

$$
    I = \int\limits_{-1}^{1}f(x) dx \approx
    h\left\{w_0 f(0) +
            \sum_{j=0}^\infty w_j\left[f(-x_j) + f(x_j)\right]\right\}.
$$

Так как веса $$ w_j $$ достаточно быстро убывают с ростом $$ j $$, то ряд можно
обрезать условием $$ jh \le 10 $$.
