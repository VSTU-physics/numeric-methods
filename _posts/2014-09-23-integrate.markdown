---
layout: post
title:  "Численное интегрирование"
date:   2014-09-23 21:12:19
categories: интегрирование
---

Существует 2 принципиально различных семейства методов численного интегрирования
функций:

1. методы Монте-Карло 
2. аппроксимация функцией с известным значением интеграла (метод прямоугольников,
трапеций, парабол и т.д.)

## Аппроксимация

Для аппроксимации обычно используют многочлены. Это обусловлено тем,
что достаточно просто построить многочлен по точкам, через которые он проходит,
а также многочлены очень просто интегрируются.

Сначала выбирают разбиение отрезка интегрирования -- выбирают точки
$$ \{ x_0, x_1, \ldots, x_n \} $$. При этом обычно $$ x_0 $$ и $$ x_n $$ --
концы интегрирования.

Затем, через эти точки проводится интерполирующий многочлен. Так как точек всего
$$ n + 1 $$, то многочлен имеет степень $$ n $$, а его коэффициенты определяются
из системы уравнений

$$ P_n(x_i) = \sum_{k=0}^n a_k x^k = f(x_i) \quad i\in\{0,\ldots,n\}, $$

которую можно переписать в матричном виде:

$$
    \begin{pmatrix}
        1 & x_0 & \cdots & x_0^n \\
        1 & x_1 & \cdots & x_1^n \\
        \vdots & \vdots & \ddots & \vdots \\
        1 & x_n & \cdots & x_n^n \\
    \end{pmatrix}
    \begin{pmatrix}
    a_0 \\ a_1 \\ \vdots \\ a_n
    \end{pmatrix}
    =
    \begin{pmatrix}
    f(x_0) \\ f(x_1) \\ \vdots \\ f(x_n)
    \end{pmatrix}
$$

Тогда выражение для интеграла принимает вид

$$
    I = \int\limits_{x_0}^{x_n} f(x)\,dx \approx
    \int\limits_{x_0}^{x_n}\sum_{k=0}^n a_k x^k\,dx =
    \sum_{k=0}^n \frac{a_k(x_n^{k+1} - x_0^{k+1})}{k+1}.
$$

В итоге, для получения ответа достаточно узнать все коэффициенты $$ a_k $$.
Для численного решения можно использовать, например,
[LUP-разложение](/СЛАУ/2014/09/29/LUP/).

## Многочлен Лагранжа
Рассмотрим многочлен вида

$$
    P_n^0(x) = \frac{x - x_1}{x_0 - x_1} \cdot \frac{x - x_2}{x_0 - x_2} \cdot
    \cdots \cdot \frac{x - x_n}{x_0 - x_n} =
    \prod_{i=1}^n \frac{x - x_i}{x_0 - x_i}.
$$

Очевидно, что $$ P_n^0(x_i) = \delta_{0i} $$. Сложив $$ n+1 $$ подобных
многочленов можно получить

$$
    L_n(x) = \sum_{i=0}^n f(x_i) \prod_{j=0}^n' \frac{x - x_j}{x_i - x_j},
$$

где штрих у произведения означает, что произведение берётся по всем
$$ j \neq i $$. Нетрудно видеть, что

$$
    L_n(x_j) = \sum_{i=0}^n f(x_i) \delta_{ij} = f(x_j),
$$

то есть этот многочлен совпадает с найденным ранее $$ P_n(x) $$. Однако, при его
интегрировании обнаруживается интересная особенность: для интегрирования нужно
знать лишь интегралы от полниномов вроде рассмотренного выше $$ P_n^0(x) $$.

$$
    \int\limits_{x_0}^{x_n} L_n(x)\,dx =
    \int\limits_{x_0}^{x_n}
    \sum_{i=0}^n f(x_i) \prod_{j=0}^n' \frac{x - x_j}{x_i - x_j}\,dx =
    \sum_{i=0}^n f(x_i)
    \int\limits_{x_0}^{x_n}\prod_{j=0}^n' \frac{x - x_j}{x_i - x_j}\,dx =
    \sum_{i=0}^n c_i f(x_i),
$$

где коэффициенты

$$
    c_i = \int\limits_{x_0}^{x_n}\prod_{j=0}^n' \frac{x - x_j}{x_i - x_j}\,dx
$$

зависят только от разбиения и не зависят от интегрируемой функции.
Следовательно, они общие для всех функций и для расчёта интеграла больше
не нужно решать систему.

Для большего обобщения можно рассмотреть отображение

$$ y : [x_0, x_n] \to [-1, 1],\ y(x) = \frac{2x - x_n - x_0}{x_n - x_0} $$

Тогда

$$
    c_i = \frac{x_n - x_0}{2}\int\limits_{-1}^{1}
          \prod_{j=0}^n' \frac{y - y_j}{y_i - y_j}\,dy.
$$

Точки $$ y_i $$ называются узлами разбиения, а соответствующие им значения
$$ c_i $$ -- весами.