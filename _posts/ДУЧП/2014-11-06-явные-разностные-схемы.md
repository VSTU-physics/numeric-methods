---
layout: post
title:  "Явные разностные схемы"
date:   2014-11-06 16:00:00
categories: ДУЧП
---

## Параболические уравнения

Рассмотрим параболическое уравнение в нормальных координатах:

$$
    \frac{\partial u}{\partial t} = \frac{\partial^2 u}{\partial x^2} + f(x, t),
    \quad  x\in(0,1),\ t > 0.
$$

Начальное и граничные условия в общем виде выглядят так:

$$
  u(x, 0) = u_0(x),\quad
  \left.\left(a_0 \frac{\partial u}{\partial x} + b_0 u\right)\right|_{x=0} = g_0(t),
  \left.\left(a_1 \frac{\partial u}{\partial x} + b_1 u\right)\right|_{x=1} = g_1(t).
$$

Для численного решения построим сетку с шагом $$ \xi $$ по оси $$ x $$
и $$ \tau $$ по оси $$ t $$ и заменим дифференциальные операторы разностными:

$$
    \frac{u_{i, j+1} - u_{i, j}}{\tau} =
    \frac{u_{i+1, j} - 2u_{i, j} + u_{i-1, j}}{\xi^2} + f_{i, j}.
$$

Отсюда можно выразить значение на следующем шаге по времени через предыдущий:

$$
    u_{i, j+1} - u_{i, j} = r(u_{i+1, j} - 2u_{i, j} + u_{i-1, j}) +
    \tau\cdot f_{i, j}, r = \frac{\tau}{\xi^2},
$$

$$
    u_{i, j+1} = (1 - 2r)u_{i, j} + r(u_{i+1, j} + u_{i-1, j})
    + \tau\cdot f_{i, j},\ i \in \{1,\ldots, n-1\}.
$$

При этом начальное условие позволит определить начальные значения:

$$
    u_{i, 0} = u_0(i \cdot \xi),
$$

а граничные -- значения на краях ($$ i \in {0, n} $$):

$$
  a_0 \frac{u_{1, j} - u_{0, j}}{\xi} + b_0 u_{0, j} = g_0(j\cdot\tau),\quad
  a_1 \frac{u_{n, j} - u_{n-1, j}}{\xi} + b_1 u_{n, j} = g_1(j\cdot\tau).
$$


{% highlight python %}
from matplotlib import pyplot as plt
from numpy import sin, pi

# количество шагов на оси x
n = 100
xi = 1.0 / n

# время наблюдения
tmax = 0.1

# шаг по времени (из условия Куранта)
r = 0.45 # < 0.5
tau = r * xi ** 2

# задаём начальное условие
u = [sin(pi * i / n) for i in range(n + 1)]

# копия, пригдится при расчёте
v = list(u)

# текущее время
t = 0

# функция источника
f = lambda x, t: 0

# профиль функции до
plt.plot([xi * i for i in range(n+1)], u)

while t < tmax:
    # пересчёт значений в середине по разносной схеме
    for i in range(1, n):
        v[i] = (1 - 2 * r) * u[i] + r * (u[i-1] + u[i+1]) + tau * f(i * xi, t)
    # пересчёт значений на краях -- пока для простоты закреплённые концы
    v[0] = 0
    v[n] = 0
    # нет времени объяснять
    u, v = v, u
    # обновление времени
    t += tau

# профиль функции после
plt.plot([xi * i for i in range(n+1)], u)

# покажи мне это
plt.show()

# в следующий раз мы научимся строить несколько профилей
# и будем задавать странные граничные условия
{% endhighlight %}
